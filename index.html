<!DOCTYPE html>
<html>
  <head>
    <title>SSH Hardening Guides</title>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <link rel="stylesheet" type="text/css" href="main.css" />
    <script type="text/javascript" src="hardening_guides.js"></script>
  </head>
  <body>
    <div id="content">
      <div id="header">
	<div id="logo">
	  <a href="https://www.positronsecurity.com/"><img class="logo" src="positron-security.png"/></a>
	</div>
	<div id="nav"><a class="navlink" href="/">Home</a></div>
	<br class="clear"/>
      </div>
      <h1>SSH Hardening Guides</h1>
      <p>Below are guides to hardening SSH on various systems.  Note that following them may not result in a perfect auditing score, as not all packaged SSH server versions support the required options.  However, these instructions will result in the best possible score.</p>
    <p>These guides were inspired by <a href="https://stribika.github.io/2015/01/04/secure-secure-shell.html">this document</a> (which is now out-dated).</p>
    <p><h3>Server Guides:</h3></p>
    <p><ol class="system_list">
    <li><a href="#amazon_linux_2023">Amazon Linux 2023</a></li>
    <li><a href="#debian_11">Debian 11 (Bullseye)</a></li>
    <li><a href="#debian_12">Debian 12 (Bookworm)</a></li>
    <li><a href="#rocky_9">Rocky Linux 9</a></li>
    <li><a href="#ubuntu_20_04_lts">Ubuntu 20.04 LTS</a></li>
    <li><a href="#ubuntu_22_04_lts">Ubuntu 22.04 LTS</a></li>
    <li><a href="#ubuntu_24_04_lts">Ubuntu 24.04 LTS</a></li>
    </ol></p>
    <p><h3>Client Guides:</h3></p>
    <p><ol class="system_list">
    <li><a href="#amazon_linux_2023_client">Amazon Linux 2023</a></li>
    <li><a href="#debian_12_client">Debian 12 (Bookworm)</a></li>
    <li><a href="#rocky_9_client">Rocky Linux 9</a></li>
    <li><a href="#ubuntu_20_04_linux_mint_20">Ubuntu 20.04 LTS / Linux Mint 20</a></li>
    <li><a href="#ubuntu_22_04_linux_mint_21">Ubuntu 22.04 LTS / Linux Mint 21</a></li>
    <li><a href="#ubuntu_24_04_client">Ubuntu 24.04 LTS / Linux Mint 22</a></li>
    </ol></p>

    <p><h3>Community-Developed Guides:</h3></p>
    <p>The following guides have been written by the community.  They have not been officially tested, and are not officially supported:</p>
    <p><ol class="system_list">
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/ArubaOS-Switch-(AOS-S)-16.11">ArubaOS Switch (AOS S) 16.11</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Dropbear-2022.83">Dropbear 2022.83</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Extreme-Networks-(Fabric-Engine-and-Switch-Engine)">Extreme Networks (Fabric Engine and Switch Engine)</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Fortinet-FortiOS">Fortinet FortiOS</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/FreeBSD">FreeBSD (various versions)</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/macOS-13-(Ventura)-&-14-(Sonoma)">Mac OS 13 (Ventura) & 14 (Sonoma)</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Mikrotik-RouterOS">Mikrotik RouterOS</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/OPNsense-20.7-and-newer">OPNsense 20.7 and newer</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Proxmox-VE-7.3-6">Proxmox-VE-7.3-6</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Synology-DSM">Synology DSM</a></li>
    <li><a href="https://github.com/jtesta/ssh-audit/wiki/Void-Linux">Void Linux</a></li>
    </ol></p>
    <p>Instructions for submitting a hardening guide <a href="https://github.com/jtesta/ssh-audit/wiki/SSH-Hardening-Guides-Index">can be found here</a>.</p>

    <p><h3>Legacy Guides:</h3></p>
    <p><ol class="system_list">
    <li><a href="#debian_10">Debian Buster (Debian 10)</a></li>
    <li><a href="#openbsd_6_2">OpenBSD 6.2</a></li>
    <li><a href="#pfsense_2_4">pfSense 2.4</a></li>
    <li><a href="#rhel7">RedHat Enterprise Linux 7 / CentOS 7</a></li>
    <li><a href="#rhel8">RedHat Enterprise Linux 8 / CentOS 8</a></li>
    <li><a href="#ubuntu_14_04_lts">Ubuntu 14.04 LTS</a></li>
    <li><a href="#ubuntu_16_04_lts">Ubuntu 16.04 LTS (Server)</a></li>
    <li><a href="#ubuntu_16_04_linux_mint_18">Ubuntu 16.04 LTS / Linux Mint 18 (Client)</a></li>
    <li><a href="#ubuntu_18_04_lts">Ubuntu 18.04 LTS</a></li>
    <li><a href="#ubuntu_18_04_linux_mint_19">Ubuntu 18.04 LTS / Linux Mint 19 (Client)</a></li>
    <li><a href="#ubuntu_core_16">Ubuntu Core 16</a></li>
    <li><a href="#ubuntu_core_18">Ubuntu Core 18</a></li>
    </ol></p>

    <hr>

    <div id="ubuntu_24_04_lts">
    <p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 24.04 LTS Server <span class="last_modified">Last modified: September 1, 2025</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
    <div class="change_log">
      <p>Change Log:</p>
      <ol>
        <li>September 1, 2025: Removed commands directly editing sshd_config to make system updates easier for users.</li>
        <li>October 1, 2024: Added RequiredRSASize directive to enforce a minimum of 3072-bit user and host-based authentication keys.</li>
        <li>April 29, 2024: Initial revision.  In comparison to Ubuntu 22.04 LTS guide, the following changes were made: 1.) For key exchanges, diffie-hellman-group18-sha512 and diffie-hellman-group-exchange-sha256 were prioritized over diffie-hellman-group16-sha512 due to greater security strength; GSS algorithms were prioritized over their non-GSS equivalents in order to match the client guide, 2.) For ciphers, 256-bit AES ciphers were prioritized over 192 and 128-bit AES ciphers due to their increased resistence against quantum computing attacks (previously, weaker GCM ciphers had priority over CTR ciphers), 3.) The HostbasedAcceptedAlgorithms and PubkeyAcceptedAlgorithms settings are now the same as HostKeyAlgorithms setting, 4.) The hmac-sha2-512-etm@openssh.com MAC was increased in priority due to its increased resistence against quantum computing attacks, and 5.) The ED25519 host keys were given priority over RSA host keys due to their greater efficiency.</li>
      </ol>
    </div>
    <p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the ED25519 and RSA keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""
</span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
    <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256,gss-group16-sha512-,diffie-hellman-group16-sha512\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com\n\nRequiredRSASize 3072\n\nHostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nCASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nGSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\nHostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nPubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256" > /etc/ssh/sshd_config.d/ssh-audit_hardening.conf</span></li>
    <li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
    <li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br></span><p>Enable persistence of the iptables rules across server reboots:</p><span class="commands">DEBIAN_FRONTEND=noninteractive apt install -q -y netfilter-persistent iptables-persistent<br>service netfilter-persistent save</span></li>
    </ol>
    <br>
    <u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
    </div>

    <hr>

    <div id="ubuntu_22_04_lts">
    <p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 22.04 LTS Server <span class="last_modified">Last modified: April 22, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
    <div class="change_log">
      <p>Change Log:</p>
      <ol>
        <li>October 1, 2024: Re-ordered host keys to prioritize ED25519 due to efficiency. Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
        <li>April 22, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
      </ol>
    </div>
    <p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
    <li><h3>Enable the ED25519 and RSA keys</h3>Enable the ED25519 and RSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">echo -e "\nHostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key" >> /etc/ssh/sshd_config</span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
     <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,gss-curve25519-sha256-,diffie-hellman-group16-sha512,gss-group16-sha512-,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\nHostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nCASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nGSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\nHostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\nPubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256" > /etc/ssh/sshd_config.d/ssh-audit_hardening.conf</span></li>
    <li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br></span><p>Enable persistence of the iptables rules across server reboots:</p><span class="commands">DEBIAN_FRONTEND=noninteractive apt install -q -y netfilter-persistent iptables-persistent<br>service netfilter-persistent save</span></li>
    <li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
    </ol>
    <br>
    <u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
    </div>

    <hr>

    <div id="ubuntu_20_04_lts">
    <p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 20.04 LTS Server <span class="last_modified">Last modified: April 24, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
    <div class="change_log">
      <p>Change Log:</p>
      <ol>
        <li>April 24, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
      </ol>
    </div>
    <p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
    <li><h3>Enable the RSA and ED25519 keys</h3>Enable the RSA and ED25519 <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^\#HostKey \/etc\/ssh\/ssh_host_\(rsa\|ed25519\)_key$/HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config</span></li>
    <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\nHostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com" > /etc/ssh/sshd_config.d/ssh-audit_hardening.conf</span></li>
    <li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
    <li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br></span><p>Enable persistence of the iptables rules across server reboots:</p><span class="commands">DEBIAN_FRONTEND=noninteractive apt install -q -y netfilter-persistent iptables-persistent<br>service netfilter-persistent save</span></li>
    </ol>
    <br>
    <u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
    </div>

    <hr>

    <div id="ubuntu_18_04_lts">
    <p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 18.04 LTS Server <span class="last_modified">Last modified: February 8, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
    <p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
    <li><h3>Disable the DSA and ECDSA host keys</h3>Comment out the DSA and ECDSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^HostKey \/etc\/ssh\/ssh_host_\(dsa\|ecdsa\)_key$/\#HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config</span></li>
    <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\nHostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com" >> /etc/ssh/sshd_config</span></li>
    <li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
    </ol>
    <br>
    <u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
    </div>

<hr>

<div id="ubuntu_16_04_lts">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 16.04 LTS Server <span class="last_modified">Last modified: July 6, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate ED25519 key</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Disable the RSA, DSA, and ECDSA host keys</h3>Comment out the RSA, DSA and ECDSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^HostKey \/etc\/ssh\/ssh_host_\(rsa\|dsa\|ecdsa\)_key$/\#HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="ubuntu_14_04_lts">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 14.04 LTS Server <span class="last_modified">Last modified: October 17, 2017</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Disable the DSA and ECDSA host keys</h3>Comment out the DSA and ECDSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^HostKey \/etc\/ssh\/ssh_host_\(dsa\|ecdsa\)_key$/\#HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="ubuntu_core_18">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu Core 18 Server <span class="last_modified">Last modified: October 6, 2019</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3>
<u>Note</u>: It is highly recommended that you run the <i>ssh-keygen</i> commands below on another host.  Some IoT devices do not have good entropy sources to generate sufficient keys with!<br><br>
<span class="commands">ssh-keygen -t rsa -b 4096 -f ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f ssh_host_ed25519_key -N ""
</span>
<br><br>Be sure to upload the following 4 files to the target device's <i>/etc/ssh</i> directory:<ul><li>ssh_host_ed25519_key</li><li>ssh_host_ed25519_key.pub</li><li>ssh_host_rsa_key</li><li>ssh_host_rsa_key.pub</li></ul>
</li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Only enable RSA and ED25519 host keys.\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh reload</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="ubuntu_core_16">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu Core 16 Server <span class="last_modified">Last modified: October 17, 2017</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3>
<u>Note</u>: It is highly recommended that you run the <i>ssh-keygen</i> commands below on another host.  Some IoT devices do not have good entropy sources to generate sufficient keys with!<br><br>
<span class="commands">ssh-keygen -t rsa -b 4096 -f ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f ssh_host_ed25519_key -N ""
</span>
<br><br>Be sure to upload the following 4 files to the target device's <i>/etc/ssh</i> directory:<ul><li>ssh_host_ed25519_key</li><li>ssh_host_ed25519_key.pub</li><li>ssh_host_rsa_key</li><li>ssh_host_rsa_key.pub</li></ul>
</li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">sed -i 's/^MACs \(.*\)$/\#MACs \1/g' /etc/ssh/sshd_config<br>
echo -e "\n# Restrict MAC algorithms, as per sshaudit.com hardening guide.\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh reload</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="debian_12">
<p><h2 class="os-title">Debian Bookworm (Debian 12) <span class="last_modified">Last modified: April 18, 2025</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>April 18, 2025: Added sntrup761x25519-sha512 to KexAlgorithms.</li>
    <li>October 1, 2024: Re-ordered host keys to prioritize ED25519 due to efficiency.  Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>April 24, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
  </ol>
</div>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Enable the ED25519 and RSA keys</h3>Enable the ED25519 and RSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">echo -e "\nHostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key" >> /etc/ssh/sshd_config</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\n
KexAlgorithms sntrup761x25519-sha512,sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,gss-curve25519-sha256-,diffie-hellman-group16-sha512,gss-group16-sha512-,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\nHostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nRequiredRSASize 3072\n\nCASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nGSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\nHostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\nPubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n" > /etc/ssh/sshd_config.d/ssh-audit_hardening.conf</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
<li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">DEBIAN_FRONTEND=noninteractive apt install -q -y iptables netfilter-persistent iptables-persistent<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br></span><p>Enable persistence of the iptables rules across server reboots:</p><span class="commands">service netfilter-persistent save</span></li>
</ol>
</p>
</div>

<hr>

<div id="debian_11">
<p><h2 class="os-title">Debian Bullseye (Debian 11) <span class="last_modified">Last modified: September 17, 2021</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""<br>
</span></li>
    <li><h3>Enable the RSA and ED25519 keys</h3>Enable the RSA and ED25519 <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^\#HostKey \/etc\/ssh\/ssh_host_\(rsa\|ed25519\)_key$/HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config<br></span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli<br></span></li>
    <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\nHostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com" > /etc/ssh/sshd_config.d/ssh-audit_hardening.conf</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
</ol></p>
</div>

<hr>

<div id="debian_10">
<p><h2 class="os-title">Debian Buster (Debian 10) <span class="last_modified">Last modified: September 17, 2021</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
    <li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""<br>
</span></li>
    <li><h3>Enable the RSA and ED25519 keys</h3>Enable the RSA and ED25519 <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^\#HostKey \/etc\/ssh\/ssh_host_\(rsa\|ed25519\)_key$/HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config<br></span></li>
    <li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli<br></span></li>
    <li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\nHostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com" >> /etc/ssh/sshd_config<br></span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service ssh restart</span></li>
</ol></p>
</div>

<hr>

<div id="rocky_9">
<p><h2 class="os-title"><img class="distro_logo" src="rocky.svg"/> Rocky Linux 9 <span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Re-ordered host keys to prioritize ED25519 due to efficiency.  Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>April 24, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
  </ol>
</div>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Enable the ED25519 and RSA keys</h3>Enable the ED25519 and RSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">echo -e "\nHostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key" >> /etc/ssh/sshd_config</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,gss-curve25519-sha256-,diffie-hellman-group16-sha512,gss-group16-sha512-,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\nHostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nRequiredRSASize 3072\n\nCASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nGSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\nHostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\nPubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n" > /etc/crypto-policies/back-ends/opensshserver.config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">systemctl restart sshd</span></li>
<li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables/firewalld to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">firewall-cmd --permanent --direct --add-rule ipv4 filter INPUT 0 -p tcp --dport 22 -m state --state NEW -m recent --set<br>
firewall-cmd --permanent --direct --add-rule ipv4 filter INPUT 1 -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
firewall-cmd --permanent --direct --add-rule ipv6 filter INPUT 0 -p tcp --dport 22 -m state --state NEW -m recent --set<br>
firewall-cmd --permanent --direct --add-rule ipv6 filter INPUT 1 -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP</span><p>Reload firewalld to enable new rules:</p><span class="commands">systemctl reload firewalld</span></li>
</ol>
</p>
</div>

<hr>

<div id="rhel8">
<p><h2 class="os-title">RedHat Enterprise Linux 8 Server / CentOS 8 Server <span class="last_modified">Last modified: October 20, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""<br>
chgrp ssh_keys /etc/ssh/ssh_host_ed25519_key /etc/ssh/ssh_host_rsa_key<br>
chmod g+r /etc/ssh/ssh_host_ed25519_key /etc/ssh/ssh_host_rsa_key
</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Disable ECDSA host key</h3>Comment out the ECDSA <i>HostKey</i> directive in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^HostKey \/etc\/ssh\/ssh_host_ecdsa_key$/\#HostKey \/etc\/ssh\/ssh_host_ecdsa_key/g' /etc/ssh/sshd_config</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">cp /etc/crypto-policies/back-ends/opensshserver.config /etc/crypto-policies/back-ends/opensshserver.config.orig<br>
echo -e "CRYPTO_POLICY='-oCiphers=chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr -oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com -oGSSAPIKexAlgorithms=gss-curve25519-sha256- -oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256 -oHostKeyAlgorithms=ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512 -oPubkeyAcceptedKeyTypes=ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512'" > /etc/crypto-policies/back-ends/opensshserver.config<br>
</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">systemctl restart sshd.service</span></li>
</ol></p>
</div>

<hr>

<div id="rhel7">
<p><h2 class="os-title">RedHat Enterprise Linux 7 Server / CentOS 7 Server <span class="last_modified">Last modified: February 18, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Disable automatic re-generation of RSA & ECDSA keys</h3><span class="commands">mkdir -p /etc/systemd/system/sshd-keygen.service.d<br>
cat << EOF > /etc/systemd/system/sshd-keygen.service.d/ssh-audit.conf<br>
[Unit]<br>
ConditionFileNotEmpty=<br>
ConditionFileNotEmpty=!/etc/ssh/ssh_host_ed25519_key<br>
EOF<br>
systemctl daemon-reload</span>
<li><h3>Re-generate the ED25519 key</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""<br>
chgrp ssh_keys /etc/ssh/ssh_host_ed25519_key<br>
chmod g+r /etc/ssh/ssh_host_ed25519_key
</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Disable the RSA, DSA, and ECDSA host keys</h3>Comment out the RSA, DSA, and ECDSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">sed -i 's/^HostKey \/etc\/ssh\/ssh_host_\(rsa\|dsa\|ecdsa\)_key$/\#HostKey \/etc\/ssh\/ssh_host_\1_key/g' /etc/ssh/sshd_config</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "\n# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group18-sha512,diffie-hellman-group16-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">systemctl restart sshd.service</span></li>
</ol></p>
</div>

<hr>

<div id="amazon_linux_2023">
<p><h2 class="os-title">Amazon Linux 2023 <span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Re-ordered host keys to prioritize ED25519 due to efficiency.  Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>April 22, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
    <li>March 15, 2024: Initial revision.</li>
  </ol>
</div>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm -f /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Enable the ED25519 and RSA keys</h3>Enable the ED25519 and RSA <i>HostKey</i> directives in the <i>/etc/ssh/sshd_config</i> file:<br><br><span class="commands">echo -e "\nHostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key" >> /etc/ssh/sshd_config</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,gss-curve25519-sha256-,diffie-hellman-group16-sha512,gss-group16-sha512-,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\nHostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nCASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\nGSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\nHostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\nPubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n" > /etc/crypto-policies/back-ends/opensshserver.config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">systemctl restart sshd</span></li>
<li><h3>Implement connection rate throttling</h3><p>Connection rate throttling is needed in order to protect against the <a href="https://www.positronsecurity.com/blog/2024-04-23-an-analysis-of-dheat-dos-against-ssh-in-cloud-environments/">DHEat denial-of-service attack</a>.  A complete and flexible solution is to use iptables to allow up to 10 connections every 10 seconds from any one source address.  An alternate solution is to set OpenSSH's PerSourceMaxStartups directive to 1 (note, however, that this can cause incomplete results during ssh-audit scans, as well as other client failures when bursts of connections are made).</p><span class="commands">dnf install -y iptables<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
iptables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --set<br>
ip6tables -I INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 10 --hitcount 10 -j DROP<br></span><p>Enable persistence of the iptables rules across server reboots:</p><span class="commands">dnf install -y iptables-services<br>iptables-save > /etc/sysconfig/iptables<br>ip6tables-save > /etc/sysconfig/ip6tables<br>systemctl enable iptables<br>systemctl enable ip6tables<br>systemctl start iptables<br>systemctl start ip6tables</span></li>
</ol>
</p>
</div>

<hr>

<div id="pfsense_2_4">
<p><h2 class="os-title"><img src="pfsense.png"/> pfSense 2.4 <span class="last_modified">Last modified: October 17, 2017</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Remove small Diffie-Hellman moduli</h3><span class="commands">awk '$5 >= 3071' /etc/ssh/moduli > /etc/ssh/moduli.safe<br>
mv -f /etc/ssh/moduli.safe /etc/ssh/moduli</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">sed -i.bak 's/^MACs \(.*\)$/\#MACs \1/g' /etc/ssh/sshd_config && rm /etc/ssh/sshd_config.bak<br>
echo "" | echo "MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">service sshd onerestart</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="openbsd_6_2">
<p><h2 class="os-title"><img src="openbsd.png"/> OpenBSD 6.2 Server <span class="last_modified">Last modified: October 20, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<p><u>Note</u>: all commands below are to be executed as the <i>root</i> user.<ol>
<li><h3>Re-generate the RSA and ED25519 keys</h3><span class="commands">rm /etc/ssh/ssh_host_*<br>
ssh-keygen -t rsa -b 4096 -f /etc/ssh/ssh_host_rsa_key -N ""<br>
ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key -N ""
</span></li>
<li><h3>Create custom Diffie-Hellman groups</h3><span class="commands">ssh-keygen -G /etc/ssh/moduli -b 3072</span><br><br><u>Note:</u> This will likely take some time to complete.</li>
<li><h3>Disable the DSA and ECDSA host keys</h3><span class="commands">echo -e "\n# Restrict host keys to ED25519 and RSA only.\nHostKeyAlgorithms ssh-ed25519\n" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restrict supported key exchange, cipher, and MAC algorithms</h3><span class="commands">echo -e "# Restrict key exchange, cipher, and MAC algorithms, as per sshaudit.com\n# hardening guide.\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com" >> /etc/ssh/sshd_config</span></li>
<li><h3>Restart OpenSSH server</h3><span class="commands">kill -HUP `cat /var/run/sshd.pid`</span></li>
</ol>
<br>
<u>Note</u>: <a href="https://bugzilla.mindrot.org/show_bug.cgi?id=2793">Because of a bug in OpenSSH</a>, 2048-bit DH moduli will still be used in some limited circumstances.  Only a maximum score of 95% is possible.</p>
</div>

<hr>

<div id="amazon_linux_2023_client">
<p><h2 class="os-title">Amazon Linux 2023 Client<span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>April 22, 2024: added connection throttling instructions to counteract the DHEat denial-of-service attack.</li>
    <li>March 15, 2024: Initial revision.</li>
  </ol>
</div>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\n KexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,gss-group16-sha512-,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\n MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\n HostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n CASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n GSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\n HostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n PubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="debian_12_client">
<p><h2 class="os-title">Debian 12 Client<span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Added RequiredRSASize directive to enforce a minimum of 3072-bit user and host-based authentication keys.  Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>March 15, 2024: Initial revision.</li>
  </ol>
</div>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\n KexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,gss-group16-sha512-,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\n MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\n RequiredRSASize 3072\n\n HostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n CASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n GSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\n HostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n PubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="rocky_9_client">
<p><h2 class="os-title"><img class="distro_logo" src="rocky.svg"/> Rocky Linux 9 Client<span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Added RequiredRSASize directive to enforce a minimum of 3072-bit user and host-based authentication keys.  Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
    <li>March 15, 2024: Initial revision.</li>
  </ol>
</div>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\n KexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,gss-group16-sha512-,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\n MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\n RequiredRSASize 3072\n\n HostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n CASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n GSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\n HostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n PubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="ubuntu_24_04_client">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 24.04 LTS Client / <img src="linux_mint.png"/> Linux Mint 22 Client<span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Added RequiredRSASize directive to enforce a minimum of 3072-bit user and host-based authentication keys.</li>
    <li>April 29, 2024: Initial revision.  In comparison to Ubuntu 22.04 LTS Client guide, the following changes were made: 1.) For key exchanges, diffie-hellman-group18-sha512 and diffie-hellman-group-exchange-sha256 were prioritized over diffie-hellman-group16-sha512 due to greater security strength, 2.) For ciphers, 256-bit AES ciphers were prioritized over 192 and 128-bit AES ciphers due to their increased resistence against quantum computing attacks (previously, weaker GCM ciphers had priority over CTR ciphers), 3.) The HostbasedAcceptedAlgorithms and PubkeyAcceptedAlgorithms settings are now the same as HostKeyAlgorithms setting, and 4.) The hmac-sha2-512-etm@openssh.com MAC was increased in priority due to its increased resistence against quantum computing attacks.</li>
  </ol>
</div>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\n KexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256,gss-group16-sha512-,diffie-hellman-group16-sha512\n\n MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com\n\n RequiredRSASize 3072\n\n HostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n CASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n GSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\n HostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n PubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="ubuntu_22_04_linux_mint_21">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 22.04 LTS Client / <img src="linux_mint.png"/> Linux Mint 21 Client<span class="last_modified">Last modified: October 1, 2024</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<div class="change_log">
  <p>Change Log:</p>
  <ol>
    <li>October 1, 2024: Re-ordered cipher list to prioritize larger key sizes as a countermeasure to quantum attacks.</li>
  </ol>
</div>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr\n\n KexAlgorithms sntrup761x25519-sha512@openssh.com,gss-curve25519-sha256-,curve25519-sha256,curve25519-sha256@libssh.org,gss-group16-sha512-,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n\n MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n\n HostKeyAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n CASignatureAlgorithms sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256\n\n GSSAPIKexAlgorithms gss-curve25519-sha256-,gss-group16-sha512-\n\n HostbasedAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n PubkeyAcceptedAlgorithms sk-ssh-ed25519-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-256\n\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="ubuntu_20_04_linux_mint_20">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 20.04 LTS Client / <img src="linux_mint.png"/> Linux Mint 20 Client<span class="last_modified">Last modified: October 20, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n  Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n  KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n  MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n  HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="ubuntu_18_04_linux_mint_19">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 18.04 LTS Client / <img src="linux_mint.png"/> Linux Mint 19 Client<span class="last_modified">Last modified: October 20, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n  Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n  KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256\n  MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n  HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

<div id="ubuntu_16_04_linux_mint_18">
<p><h2 class="os-title"><img src="ubuntu.png"/> Ubuntu 16.04 LTS Client / <img src="linux_mint.png"/> Linux Mint 18 Client<span class="last_modified">Last modified: October 20, 2020</span><span class="copy_button"><input class="copy_button" type="button" value="Copy commands to clipboard"/></span></h2></p>
<ul>
<li><h3>Run the following in a terminal to harden the SSH client for the local user:</h3><span class="commands">mkdir -p -m 0700 ~/.ssh; echo -e "\nHost *\n  Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n  KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256\n  MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,umac-128-etm@openssh.com\n  HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512\n" >> ~/.ssh/config</span></li>
</ul>
</div>

<hr>

</div>
</body>
</html>
